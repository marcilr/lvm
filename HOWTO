HOWTO
Created Fri Jul 13 10:19:47 AKDT 2012
Copyright (C) 2012 by Raymond E. Marcil <marcilr@gmail.com>


LVM (Logical Volume Manager) HOWTO


Sections
========
o Create "backups" LVM
o Initializing disks or disk partitions
o Removing a logical volume
o Removing a volume group


Create "backups" LVM
====================
Configured RAID5, with 4x Seagate ST31000340NS 1TB drives, attached to 9650SE-8LPML on bornite.
Need to configure a "backups" LVM for routine backups of the c0 unit (on 9650SE-16ML controller)
to the c5 unit on the 9650SE-8LPML controller.

# tw_cli info

Ctl   Model        (V)Ports  Drives   Units   NotOpt  RRate   VRate  BBU
------------------------------------------------------------------------
c0    9650SE-16ML  16        8        1       0       1       1      OK       
c5    9650SE-8LPML 8         4        1       0       1       1      OK       

#

1. Initialize /dev/sdd1 partition on 9650SE-8LPML RAID5.

# pvcreate /dev/sdd1
  Physical volume "/dev/sdd1" successfully created
#

This creates a volume group descriptor at the start of the /dev/sdd1 partition. 



Initializing disks or disk partitions
=====================================
Before you can use a disk or disk partition as a physical volume you will have to initialize it.

Use pvcreate to initialize a disk or disk partition.

Run pvcreate on the disk:
# pvcreate /dev/hdb

This creates a volume group descriptor at the start of disk.

NOTE: Using the whole disk as a PV (as opposed to a partition spanning the whole disk) is not
recommended because of the management issues it can create.  Any other OS that looks at the disk
will not recognize the LVM metadata and display the disk as being free, so it is likely it will be
overwritten.  LVM itself will work fine with whole disk PVs. 

Run pvcreate on the partition:
# pvcreate /dev/hdb1

This creates a volume group descriptor at the start of the /dev/hdb1 partition.


Removing a logical volume
=========================
A logical volume must be closed before it can be removed:

# umount /dev/myvg/homevol
# lvremove /dev/myvg/homevol
lvremove -- do you really want to remove "/dev/myvg/homevol"? [y/n]: y
lvremove -- doing automatic backup of volume group "myvg"
lvremove -- logical volume "/dev/myvg/homevol" successfully removed

tldp.org/

Example (remove backups lvm on bornite):

# lvremove /dev/backups/backups 
Do you really want to remove active logical volume backups? [y/n]: y
  Logical volume "backups" successfully removed
# 


Removing a volume group
=======================
Make sure that no logical volumes are present in the volume group, see later section for how to do
this.

Deactivate the volume group:
# vgchange -a n my_volume_group

Now you actually remove the volume group:
# vgremove my_volume_group

Example (remove backups volume group on bornite):

Deactivate the volume group: 
# vgchange -a n backups
  0 logical volume(s) in volume group "backups" now active
#
        
Now you actually remove the volume group:
# vgremove backups
  Volume group "backups" successfully removed
#



Links
=====
LVM HOWTO
http://tldp.org/HOWTO/LVM-HOWTO/

11.1. Initializing disks or disk partitions
http://tldp.org/HOWTO/LVM-HOWTO/initdisks.html

11.8. Removing a logical volume
http://tldp.org/HOWTO/LVM-HOWTO/removelv.html

11.4. Removing a volume group
Chapter 11. Common Tasks
http://tldp.org/HOWTO/LVM-HOWTO/removevgs.html

Logical volume management
From Wikipedia, the free encyclopedia
http://en.wikipedia.org/wiki/Logical_volume_management
